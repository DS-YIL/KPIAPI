<div class="container-fluid">
  <nb-card>
    <nb-card-body>
     <h6 style="text-align: center"> Management QI/KPI</h6>   
      <p-table [columns]="cols" [value]="dataList" [(selection)]="data" dataKey="ID" [paginator]="true" [rows]="7" [responsive]="true" >
        <ng-template pTemplate="caption">
          <!-- <div class="ui-helper-clearfix" style="text-align: left">
              <button type="button" pButton icon="pi pi-file-excel" iconPos="left" label="EXCEL" (click)="exportExcel()" style="margin-right: 0.5em;" class="ui-button-success"></button>
               </div> -->
      </ng-template>
        <ng-template pTemplate="header" let-columns>
            <tr>
                <th style="width: 3em">
                    <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                </th>
                <!-- <th *ngFor="let col of columns">
                    {{col.header}}
                </th> -->
                <th style="width:7em;background-color: #007ad9;color: #ffffff;text-align: center">Sl No.</th>
                <th style="width:7em;background-color: #007ad9;color: #ffffff;text-align: center;">Dept Name</th>
          <th style="width:7em;background-color: #007ad9;color: #ffffff;text-align: center">CWQP No.</th>
          <th style="width:8em;background-color: #007ad9;color: #ffffff;text-align: center">Quality Indices</th>
          <th style="width:8em;background-color: #007ad9;color: #ffffff;text-align: center">Measurement</th>
          <th style="width:10em;background-color: #007ad9;color: #ffffff;text-align: center">Criteria</th>
          <th style="width:8em;background-color: #007ad9;color: #ffffff;text-align: center">Purpose</th>
          <th  style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">Target</th>
          <th *ngIf="displayApr" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displayMay" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displayJun" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">NewTarget</th>
          <th *ngIf="displayJul" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displayAug" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displaySep" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displayOct" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displayNov" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displayDec" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displayJan" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displayFeb" style="width:5em;background-color: #007ad9;color: #ffffff;">New Target</th>
          <th *ngIf="displayMar" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>

            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-columns="columns" let-ri="rowIndex">
            <tr [pSelectableRow]="rowData">
                <td>
                    <p-tableCheckbox [value]="rowData"></p-tableCheckbox>
                </td>
                <!-- <td *ngFor="let col of columns" >
                    {{rowData[col.field]}}
                </td> -->
                <td style="text-align: center">
                  {{ri+1}}
                </td>
                <td style="text-align: left">
                    {{rowData.DeptName}}
                  </td>
                  <td style="text-align: left">
                    {{rowData.CWQPNo}}
                  </td>
                  <td style="text-align: left">
                    {{rowData.QualityIndices}}
                  </td>
                  <td style="text-align: left">
                    {{rowData.Measurment}}
                  </td>
                  <td style="text-align: left">
                    {{rowData.Criteria}}
                  </td>
                  
                  <td style="text-align: left">
                    {{rowData.Purpose}}
                  </td>
                  <td style="text-align: left">
                    {{rowData.Target}}
                  </td>
                  <td *ngIf="displayApr" style="text-align: right">
                    {{rowData.aprTarget}}
                  </td>
                  <td *ngIf="displayMay" style="width:5em;text-align: right">
                    {{rowData.mayTarget}}
                  </td>
                  <td *ngIf="displayJun" style="width:5em;text-align: right">
                    {{rowData.junTarget}}
                  </td>
                  <td *ngIf="displayJul" style="width:5em;text-align: right">
                    {{rowData.julTarget}}
                  </td>
                  <td *ngIf="displayAug" style="width:5em;text-align: right">
                    {{rowData.augTarget}}
                  </td>
                  <td *ngIf="displaySep" style="width:5em;text-align: right">
                    {{rowData.sepTarget}}
                  </td>
                  <td *ngIf="displayOct" style="width:5em;text-align: right">
                    {{rowData.octTarget}}
                  </td>
                  <td *ngIf="displayNov" style="width:5em;text-align: right">
                    {{rowData.novTarget}}
                  </td>
                  <td *ngIf="displayDec" style="width:5em;text-align: right">
                    {{rowData.decTarget}}
                  </td>
                  <td *ngIf="displayJan" style="width:5em;text-align: right">
                    {{rowData.janTarget}}
                  </td>
                  <td *ngIf="displayFeb" style="width:5em;text-align: right">
                    {{rowData.febTarget}}
                  </td>
                  <td *ngIf="displayMar" style="width:5em;text-align: right">
                    {{rowData.marTarget}}
                  </td>
        
            </tr>
        </ng-template>
       
    </p-table>
    <p-dialog header="Filtered KPI" [(visible)]="displayDialog" [responsive]="true" showEffect="fade" 
    [modal]="true" [style]="{width:'1000px'}">
    <p-table [columns]="cols" [value]="data"  dataKey="KpiId" [paginator]="true" [rows]="7" [responsive]="true" >
      <ng-template pTemplate="caption">
        <div class="ui-helper-clearfix" style="text-align: left">
            <button type="button" pButton icon="pi pi-file-excel" iconPos="left" label="EXCEL" (click)="exportExcel()" style="margin-right: 0.5em;" class="ui-button-success"></button>
             </div>
    </ng-template>
      <ng-template pTemplate="header" let-columns>
          <tr>
              
              <!-- <th *ngFor="let col of columns">
                  {{col.header}}
              </th> -->
              <th style="width:7em;background-color: #007ad9;color: #ffffff;text-align: center">Sl No.</th>
              <th style="width:7em;background-color: #007ad9;color: #ffffff;text-align: center;">Dept Name</th>
          <th style="width:7em;background-color: #007ad9;color: #ffffff;text-align: center">CWQP No.</th>
          <th style="width:8em;background-color: #007ad9;color: #ffffff;text-align: center">Quality Indices</th>
          <th style="width:10em;background-color: #007ad9;color: #ffffff;text-align: center">Criteria</th>
          <th style="width:8em;background-color: #007ad9;color: #ffffff;text-align: center">Measurement</th>
          <th style="width:8em;background-color: #007ad9;color: #ffffff;text-align: center">Purpose</th>
          <th  style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">Target</th>
          <th *ngIf="displayApr" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displayMay" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displayJun" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">NewTarget</th>
          <th *ngIf="displayJul" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displayAug" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displaySep" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displayOct" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displayNov" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displayDec" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displayJan" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>
          <th *ngIf="displayFeb" style="width:5em;background-color: #007ad9;color: #ffffff;">New Target</th>
          <th *ngIf="displayMar" style="width:5em;background-color: #007ad9;color: #ffffff;text-align: center">New Target</th>

          </tr>
      </ng-template>
      <ng-template pTemplate="body" let-rowData let-columns="columns" let-ri="rowIndex">
          <tr [pSelectableRow]="rowData">
             
              <!-- <td *ngFor="let col of columns">
                  {{rowData[col.field]}}
              </td> -->
              <td style="text-align: center">
                {{ri+1}}
              </td>
              <td style="text-align: left">
                {{rowData.DeptName}}
              </td>
              <td style="text-align: left">
                {{rowData.CWQPNo}}
              </td>
              <td style="text-align: left">
                {{rowData.QualityIndices}}
              </td>
              <td style="text-align: left">
                {{rowData.Criteria}}
              </td>
              <td style="text-align: left">
                {{rowData.Measurment}}
              </td>
              <td style="text-align: left">
                {{rowData.Purpose}}
              </td>
              <td style="text-align: left">
                {{rowData.Target}}
              </td>
              <td *ngIf="displayApr" style="text-align: right">
                {{rowData.aprTarget}}
              </td>
              <td *ngIf="displayMay" style="width:5em;text-align: right">
                {{rowData.mayTarget}}
              </td>
              <td *ngIf="displayJun" style="width:5em;text-align: right">
                {{rowData.junTarget}}
              </td>
              <td *ngIf="displayJul" style="width:5em;text-align: right">
                {{rowData.julTarget}}
              </td>
              <td *ngIf="displayAug" style="width:5em;text-align: right">
                {{rowData.augTarget}}
              </td>
              <td *ngIf="displaySep" style="width:5em;text-align: right">
                {{rowData.sepTarget}}
              </td>
              <td *ngIf="displayOct" style="width:5em;text-align: right">
                {{rowData.octTarget}}
              </td>
              <td *ngIf="displayNov" style="width:5em;text-align: right">
                {{rowData.novTarget}}
              </td>
              <td *ngIf="displayDec" style="width:5em;text-align: right">
                {{rowData.decTarget}}
              </td>
              <td *ngIf="displayJan" style="width:5em;text-align: right">
                {{rowData.janTarget}}
              </td>
              <td *ngIf="displayFeb" style="width:5em;text-align: right">
                {{rowData.febTarget}}
              </td>
              <td *ngIf="displayMar" style="width:5em;text-align: right">
                {{rowData.marTarget}}
              </td>
    
          </tr>
      </ng-template>
      <!-- <ng-template pTemplate="footer">
          <br/><br/>
         
        
      </ng-template> -->
      
  </p-table>
  <div class="row" style="float:right">
    <button type="button"  pButton icon="pi pi-info-circle" (click)="UpdateSelectedKPI()" label="Submit"></button>
    &nbsp;&nbsp;<button type="button" (click)="hideDialog()" pButton icon="pi pi-info-circle" label="Cancel"></button>
  </div>
  </p-dialog>
  <button type="button" [disabled]="submitkpi" (click)="showDialog()" pButton icon="pi pi-info-circle" label="Finalize"></button>
  <button type="button" [disabled]="resetkpi" (click)="resetKPI()" pButton icon="pi pi-info-circle" label="Reset"></button>
    </nb-card-body>
  </nb-card>
</div>
